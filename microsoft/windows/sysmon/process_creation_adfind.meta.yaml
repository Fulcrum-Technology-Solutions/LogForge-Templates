vendor: Microsoft
product: Windows
data_source: Sysmon Process Creation - ADFind
description: Windows command line ADFinds
format: XML
frequency: high

# Generator settings
is_generator: true
base_frequency: 6  # Approximately one event every 10 seconds
time_patterns:               # List of time patterns that affect this generator
  - business_hours           # References patterns defined in config.yaml
  - night_hours
  - weekend
business_hours_multiplier: 3.0    # Higher frequency during business hours
night_hours_multiplier: 0.2       # Lower frequency after business hours
weekend_multiplier: 0.3           # Low frequency on weekends

# Context values for rendering
context:
  event_id: 1
  provider_name: "Microsoft-Windows-Sysmon"
  provider_guid: "{5770385F-C22A-43E0-BF4C-06F5698FFBD9}"
  version: 5
  level: 4
  task: 1
  opcode: 0
  keywords: "0x8000000000000000"
  channel: "Microsoft-Windows-Sysmon/Operational"
  security_user_id: "S-1-5-18"
  file_version: "1.51.00"
  description: "AdFind tool"
  product: "AdFind - AD query tool"
  company: "Joeware.net"
  original_file_name: "AdFind.exe"
  integrity_level: "Medium"
  parent_image: "C:\\Windows\\System32\\cmd.exe"
  parent_command_line: "C:\\Windows\\System32\\cmd.exe"

# Documentation for template usage
template_notes: |
  This template generates Windows Sysmon Process Creation events (EventID 1).
  It demonstrates how to:
  1. Access device properties including FQDN
  2. Format timestamps in multiple ways
  3. Generate random IDs and GUIDs
  4. Use registry functions to get domain information
  5. Create realistic file paths with username
  
  The template uses the following entity fields:
  - device.hostname or device.fqdn for the Computer field
  - user.username for the file paths and user context
  - registry.get_domain() and registry.get_netbios_domain() for domain context
  
  Custom device fields supported:
  - All standard device fields
  - Any custom_* fields will be available with device.custom_field_name

# Parameter definitions
parameters:
  - name: logon_id_format
    description: The format for LogonId (hexadecimal)
    required: false
    default: "0x0000"
  - name: hash_algorithm
    description: Hash algorithms to include (comma-separated)
    required: false
    default: "SHA1,MD5"
  - name: mitre_technique
    description: MITRE ATT&CK technique to include in RuleName
    required: false
    default: "T1018,Remote System Discovery"