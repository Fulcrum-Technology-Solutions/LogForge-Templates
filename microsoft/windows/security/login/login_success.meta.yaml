vendor: Microsoft
product: Windows
data_source: Security Login Success
description: Windows Security successful login events (EventID 4624)
format: XML
frequency: high

# Generator settings for template-based generators
is_generator: true
base_frequency: 0.2
time_patterns:
  - business_hours
  - night_hours
  - weekend
business_hours_multiplier: 2.0
night_hours_multiplier: 0.3
weekend_multiplier: 0.5

# Context values for rendering
context:
  event_id: 4624
  logon_type: 2
  session_id: 1

# Template uses Jinja2 set statement for variable reuse
# This enables consistent entity references throughout the template:
# - subject_user: The user performing the action (usually administrative)
# - target_user: The user being logged in
# - source_device: The device from which the login is occurring
# - subject_sid, target_sid: Consistently generated SIDs for both users
# - event_time: Formatted timestamp used throughout the event

# Parameter definitions
parameters:
  - name: username
    description: The username of the user logging in
    required: true
  - name: domain
    description: The domain of the user
    required: true
  - name: hostname
    description: The hostname of the machine
    required: true
  - name: ip_address
    description: Source IP address of the login
    required: true
  - name: process_id
    description: Process ID of the login process
    required: false
  - name: thread_id
    description: Thread ID of the login process
    required: false

# Example usages
examples:
  - description: Local user login
    parameters:
      username: john.doe
      domain: CONTOSO
      hostname: WIN-DC01
      ip_address: 192.168.1.100
  - description: Remote login
    parameters:
      username: admin
      domain: CONTOSO
      hostname: WIN-DC01
      ip_address: 10.0.0.5