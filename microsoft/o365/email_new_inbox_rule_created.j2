{%- set user = registry.get_random_user() -%}
{%- set device = registry.get_random_device() -%}
{%- set timestamp = current_timestamp() -%}
{%- set session_id = random_guid() -%}
{%- set request_id = random_guid() -%}
{%- set organization_id = random_guid() -%}
{%- set rule_id = random_guid() -%}
{%- set client_ip = random_public_ip() -%}
{%- set client_port = random_port() -%}
{%- set token_id = random_string(22) -%}
{%- set rule_name = ["clear category", "prcdnt.", "auto-forward", "filter mail"] | random -%}
{%- set rule_condition = ["nctracks", "ncid", "invoice", "payment", "urgent"] | random -%}
{%- set target_folder = ["RSS Subscriptions", "Inbox", "Archive", "Junk Email", "Deleted Items"] | random -%}
{%- set domain = registry.get_domain() -%}
{
  "AppAccessContext": {
    "AADSessionId": "{{ session_id }}",
    "IssuedAtTime": "1970-01-01T00:00:00",
    "UniqueTokenId": "{{ token_id }}"
  },
  "AppId": "00000002-0000-0ff1-ce00-000000000000",
  "AppPoolName": "MSExchangeOWAAppPool",
  "ClientAppId": "",
  "ClientIP": "{{ client_ip }}:{{ client_port }}",
  "CorrelationID": "",
  "CreationTime": "{{ timestamp | format_timestamp('%Y-%m-%dT%H:%M:%S') }}",
  "ExternalAccess": false,
  "Id": "{{ rule_id }}",
  "ObjectId": "NAMPR08A009.PROD.OUTLOOK.COM/Microsoft Exchange Hosted Organizations/{{ domain }}/User, {{ user.full_name }}\\{{ rule_name }}",
  "Operation": "New-InboxRule",
  "OrganizationId": "{{ organization_id }}",
  "OrganizationName": "{{ domain }}",
  "OriginatingServer": "SN6PR08MB{{ random_int(1000, 9999) }} (15.20.{{ random_int(8000, 9000) }}.{{ random_int(1, 999) }})",
  "Parameters": [
    {
      "Name": "AlwaysDeleteOutlookRulesBlob",
      "Value": "False"
    },
    {
      "Name": "Force",
      "Value": "False"
    },
    {
      "Name": "MoveToFolder",
      "Value": "{{ target_folder }}"
    },
    {
      "Name": "Name",
      "Value": "{{ rule_name }}"
    },
    {
      "Name": "SubjectOrBodyContainsWords",
      "Value": "{{ rule_condition }}"
    },
    {
      "Name": "StopProcessingRules",
      "Value": "True"
    }
  ],
  "RecordType": 1,
  "RequestId": "{{ request_id }}",
  "ResultStatus": "True",
  "SessionId": "{{ session_id }}",
  "UserId": "{{ user.username }}@{{ domain }}",
  "UserKey": "{{ user.username }}@{{ domain }}",
  "UserType": 2,
  "Version": 1,
  "Workload": "Exchange"
}