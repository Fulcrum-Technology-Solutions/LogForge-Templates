{
  "name": "organizations/{{ registry.get_organization_field('domain').split('.')[0] | default('123456789') }}/sources/{{ random_int(1000000000000000000, 9999999999999999999) }}/locations/global/findings/vuln-{{ random_guid() }}",
  "parent": "organizations/{{ registry.get_organization_field('domain').split('.')[0] | default('123456789') }}/sources/{{ random_int(1000000000000000000, 9999999999999999999) }}/locations/global",
  "resourceName": "{% set resource_type = random_weighted(['compute', 'storage', 'container'], [50, 25, 25]) %}{% if resource_type == 'compute' %}//compute.googleapis.com/projects/{{ registry.get_organization_field('domain').split('.')[0] | default('my-project') }}/zones/{{ random_choice(['us-central1-a', 'us-east1-b', 'us-west1-c']) }}/instances/{{ registry.get_random_device().hostname | default(random_hostname()) }}{% elif resource_type == 'storage' %}//storage.googleapis.com/projects/_/buckets/{{ random_choice(['app-data', 'user-uploads', 'backups', 'logs']) }}-{{ random_string(8) }}{% else %}//container.googleapis.com/projects/{{ registry.get_organization_field('domain').split('.')[0] | default('my-project') }}/zones/{{ random_choice(['us-central1-a', 'us-east1-b']) }}/clusters/{{ random_choice(['prod', 'staging', 'dev']) }}-cluster{% endif %}",
  "state": "{{ random_weighted(['ACTIVE', 'INACTIVE'], [80, 20]) }}",
  "category": "{{ random_weighted(['OS_VULNERABILITY', 'CONTAINER_VULNERABILITY', 'WEB_APPLICATION_VULNERABILITY', 'OPEN_FIREWALL', 'WEAK_SSL_CIPHER'], [35, 25, 15, 15, 10]) }}",
  "externalUri": "https://console.cloud.google.com/security/command-center/findings?organizationId={{ registry.get_organization_field('domain').split('.')[0] | default('123456789') }}",
  "sourceProperties": {
    "vulnerability": {
      "cve": {
        "id": "CVE-{{ now().year }}-{{ random_int(1000, 9999) }}",
        "cvssv3": {
          "baseScore": {{ random_choice([4.3, 5.2, 6.1, 7.5, 8.2, 9.1]) }},
          "attackVector": "{{ random_choice(['NETWORK', 'ADJACENT_NETWORK', 'LOCAL', 'PHYSICAL']) }}",
          "attackComplexity": "{{ random_choice(['LOW', 'HIGH']) }}",
          "privilegesRequired": "{{ random_choice(['NONE', 'LOW', 'HIGH']) }}",
          "userInteraction": "{{ random_choice(['NONE', 'REQUIRED']) }}",
          "scope": "{{ random_choice(['UNCHANGED', 'CHANGED']) }}",
          "confidentialityImpact": "{{ random_choice(['NONE', 'LOW', 'HIGH']) }}",
          "integrityImpact": "{{ random_choice(['NONE', 'LOW', 'HIGH']) }}",
          "availabilityImpact": "{{ random_choice(['NONE', 'LOW', 'HIGH']) }}"
        },
        "references": [
          {
            "source": "{{ random_choice(['NVD', 'MITRE', 'GitHub Advisory', 'Debian Security']) }}",
            "uri": "https://nvd.nist.gov/vuln/detail/CVE-{{ now().year }}-{{ random_int(1000, 9999) }}"
          }
        ]
      },
      "fixedPackage": {
        "packageName": "{{ random_choice(['openssl', 'libssl', 'linux-image', 'systemd', 'glibc', 'openssh-server', 'nginx', 'apache2', 'python3', 'nodejs']) }}",
        "packageVersion": "{{ random_int(1, 3) }}.{{ random_int(0, 20) }}.{{ random_int(0, 50) }}-{{ random_int(1, 10) }}",
        "packageType": "{{ random_choice(['OS', 'LANGUAGE', 'APPLICATION']) }}"
      },
      "vulnerablePackage": {
        "packageName": "{{ random_choice(['openssl', 'libssl', 'linux-image', 'systemd', 'glibc', 'openssh-server', 'nginx', 'apache2', 'python3', 'nodejs']) }}",
        "packageVersion": "{{ random_int(1, 3) }}.{{ random_int(0, 20) }}.{{ random_int(0, 50) }}-{{ random_int(1, 10) }}"
      }
    },
    "scannerName": "{{ random_weighted(['Container Threat Detection', 'VM Manager', 'Web Security Scanner', 'Security Health Analytics'], [30, 40, 15, 15]) }}",
    "scanTime": "{{ now() | iso8601 }}"
  },
  "severity": "{{ random_weighted(['CRITICAL', 'HIGH', 'MEDIUM', 'LOW'], [10, 30, 45, 15]) }}",
  "findingClass": "VULNERABILITY",
  "eventTime": "{{ now() | iso8601 }}",
  "createTime": "{{ now() | iso8601 }}",
  "canonicalName": "projects/{{ registry.get_organization_field('domain').split('.')[0] | default('123456789') }}/sources/{{ random_int(1000000000000000000, 9999999999999999999) }}/findings/vuln-{{ random_guid() }}",
  "mute": "{{ random_weighted(['UNMUTED', 'MUTED', 'UNDEFINED'], [70, 25, 5]) }}",
  "parentDisplayName": "{{ random_weighted(['Container Threat Detection', 'VM Manager', 'Web Security Scanner', 'Security Health Analytics'], [30, 40, 15, 15]) }}"
}
