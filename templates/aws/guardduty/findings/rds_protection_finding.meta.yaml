vendor: aws
product: guardduty
data_source: findings
description: AWS GuardDuty RDS Protection finding types detecting anomalous login behavior, malicious IP access, and Tor network usage on Amazon Aurora, Amazon RDS, and Aurora Limitless databases through RDS login activity monitoring, including successful logins, failed logins, brute force attacks, and database probing
format: JSON
frequency: medium
is_generator: true
base_frequency: 25
time_patterns:
  - business_hours
  - night_hours
  - weekend
business_hours_multiplier: 2.5
night_hours_multiplier: 2.0
weekend_multiplier: 1.0

documentation:
  display:
    title: "GuardDuty RDS Protection Finding Types"
    subtitle: "Threat detection for Amazon RDS and Aurora databases"
    icon: "üóÑÔ∏è"
    color_scheme: "error"
    tags:
      - "rds"
      - "database"
      - "aurora"
      - "credential-access"
      - "threat-detection"
  
  overview:
    summary: "RDS Protection detects anomalous login behavior on Amazon Aurora, Amazon RDS, and Aurora Limitless databases through RDS login activity monitoring. Uses ML anomaly detection and threat intelligence to identify suspicious database access patterns including anomalous logins, brute force attacks, malicious IP access, and Tor network usage."
    when_generated:
      - "Anomalous successful login detected on RDS database (ML-detected)"
      - "Anomalous failed login attempts detected on RDS database (ML-detected)"
      - "Successful brute force login detected after pattern of failed attempts (ML-detected)"
      - "Successful login from known malicious IP address"
      - "Failed login attempt from known malicious IP address"
      - "Malicious IP address probed RDS database (no login attempt)"
      - "Successful login from Tor exit node IP address"
      - "Failed login attempt from Tor exit node IP address"
      - "Tor exit node probed RDS database (no login attempt)"
    security_relevance: "Critical"
    compliance_frameworks:
      - "PCI-DSS 8.2, 10.2"
      - "HIPAA 164.308(a)(5), 164.312(b)"
      - "SOC 2 CC6.1, CC6.6"
      - "ISO 27001 A.9.2, A.9.4"
      - "NIST CSF PR.AC-1, DE.CM-1"
      - "CIS AWS Foundations 4.1-4.16"
    frequency_notes: "RDS Protection findings frequency depends on database access patterns and threat landscape. Production environments typically see 10-50 findings per day. Anomalous behavior findings use ML and require training period - frequency varies (5-30 per day). Malicious IP and Tor findings indicate active attacks (5-20 per day during attacks). Brute force findings are high-severity but lower frequency (1-10 per day). Discovery findings (probing without login) are medium-severity (5-15 per day)."
  
  fields:
    - name: "detail.type"
      type: "String"
      required: true
      description: "RDS Protection finding type indicating attack tactic and detection method"
      example_value: "CredentialAccess:RDS/AnomalousBehavior.SuccessfulLogin"
      template_source: "random_choice() of 9 RDS Protection finding types"
      possible_values:
        - value: "CredentialAccess:RDS/AnomalousBehavior.SuccessfulLogin"
          description: "Anomalous successful login detected (severity: Variable - Low/Medium/High based on behavior)"
        - value: "CredentialAccess:RDS/AnomalousBehavior.FailedLogin"
          description: "Anomalous failed login attempts detected (severity: Low)"
        - value: "CredentialAccess:RDS/AnomalousBehavior.SuccessfulBruteForce"
          description: "Successful brute force login after pattern of failed attempts (severity: High)"
        - value: "CredentialAccess:RDS/MaliciousIPCaller.SuccessfulLogin"
          description: "Successful login from known malicious IP address (severity: High)"
        - value: "CredentialAccess:RDS/MaliciousIPCaller.FailedLogin"
          description: "Failed login attempt from known malicious IP address (severity: Medium)"
        - value: "Discovery:RDS/MaliciousIPCaller"
          description: "Malicious IP address probed database (no login attempt) (severity: Medium)"
        - value: "CredentialAccess:RDS/TorIPCaller.SuccessfulLogin"
          description: "Successful login from Tor exit node IP address (severity: High)"
        - value: "CredentialAccess:RDS/TorIPCaller.FailedLogin"
          description: "Failed login attempt from Tor exit node IP address (severity: Medium)"
        - value: "Discovery:RDS/TorIPCaller"
          description: "Tor exit node probed database (no login attempt) (severity: Medium)"
    
    - name: "detail.resource.resourceType"
      type: "String"
      required: true
      description: "Type of RDS resource where activity was detected"
      example_value: "RDSDBInstance"
      template_source: "random_choice(['RDSDBInstance', 'RDSLimitlessDB'])"
      possible_values:
        - value: "RDSDBInstance"
          description: "Amazon RDS or Aurora database instance"
        - value: "RDSLimitlessDB"
          description: "Aurora Limitless database"
    
    - name: "detail.resource.rdsDbInstanceDetails"
      type: "Object"
      required: true
      description: "Details about the RDS database instance"
      example_value: "{dbInstanceIdentifier, engine, engineVersion, dbClusterIdentifier, dbInstanceArn, tags}"
      template_source: "RDS instance metadata from GuardDuty"
    
    - name: "detail.resource.rdsDbInstanceDetails.engine"
      type: "String"
      required: true
      description: "Database engine type"
      example_value: "aurora-mysql"
      format: "Database engine identifier"
      template_source: "random_choice() of supported RDS engines"
      possible_values:
        - value: "aurora-mysql"
          description: "Amazon Aurora MySQL"
        - value: "aurora-postgresql"
          description: "Amazon Aurora PostgreSQL"
        - value: "mysql"
          description: "MySQL"
        - value: "postgres"
          description: "PostgreSQL"
        - value: "mariadb"
          description: "MariaDB"
        - value: "oracle-ee"
          description: "Oracle Enterprise Edition"
        - value: "sqlserver-ee"
          description: "SQL Server Enterprise Edition"
    
    - name: "detail.service.action.rdsLoginActivity"
      type: "Object"
      required: true
      description: "RDS login activity details that triggered the finding"
      example_value: "{applicationProtocol, remoteIpDetails, localPortDetails, loginAttributes, blocked}"
      template_source: "RDS login activity metadata from GuardDuty"
    
    - name: "detail.service.action.rdsLoginActivity.applicationProtocol"
      type: "String"
      required: true
      description: "Database protocol used for the connection"
      example_value: "mysql"
      format: "Protocol name"
      template_source: "random_choice(['mysql', 'postgresql', 'sqlserver', 'oracle'])"
      possible_values:
        - value: "mysql"
          description: "MySQL protocol"
        - value: "postgresql"
          description: "PostgreSQL protocol"
        - value: "sqlserver"
          description: "SQL Server protocol"
        - value: "oracle"
          description: "Oracle protocol"
    
    - name: "detail.service.action.rdsLoginActivity.loginAttributes.user"
      type: "String"
      required: true
      description: "Database user that attempted or successfully logged in"
      example_value: "admin"
      format: "Username"
      template_source: "random_choice() from registry users or common database usernames"
    
    - name: "detail.service.action.rdsLoginActivity.loginAttributes.database"
      type: "String"
      required: true
      description: "Database name that was accessed"
      example_value: "production"
      format: "Database name"
      template_source: "random_choice() of common database names"
    
    - name: "detail.service.action.rdsLoginActivity.loginAttributes.applicationName"
      type: "String"
      required: false
      description: "Application or client tool name used for the connection"
      example_value: "psql"
      format: "Application name"
      template_source: "random_choice() of common database client tools"
    
    - name: "detail.service.action.rdsLoginActivity.localPortDetails.port"
      type: "Integer"
      required: true
      description: "Database port number"
      example_value: "3306"
      format: "Integer (common database ports)"
      template_source: "random_choice([3306, 5432, 1433, 1521, 6379])"
      possible_values:
        - value: "3306"
          description: "MySQL/MariaDB default port"
        - value: "5432"
          description: "PostgreSQL default port"
        - value: "1433"
          description: "SQL Server default port"
        - value: "1521"
          description: "Oracle default port"
        - value: "6379"
          description: "Redis default port"
    
    - name: "detail.service.action.rdsLoginActivity.remoteIpDetails.ipAddressV4"
      type: "String"
      required: true
      description: "Source IP address of the database login attempt"
      example_value: "203.0.113.42"
      format: "IPv4 address"
      template_source: "random_public_ip()"
    
    - name: "detail.service.action.rdsLoginActivity.blocked"
      type: "Boolean"
      required: true
      description: "Whether the login attempt was blocked"
      example_value: "false"
      format: "Boolean"
      template_source: "random_choice(['true', 'false'])"
    
    - name: "detail.service.additionalInfo.unusual"
      type: "Object"
      required: false
      description: "ML model analysis of unusual behaviors for anomalous findings"
      example_value: "{\"userIdentity\": {\"userName\": \"anomalous\", \"asnOrg\": \"not historical\"}}"
      template_source: "Object with unusual behavior flags for ML-detected anomalies"
    
    - name: "detail.service.additionalInfo.threatListName"
      type: "String"
      required: false
      description: "Name of threat intelligence list that matched (for malicious IP findings)"
      example_value: "ProofPoint"
      format: "Threat list name"
      template_source: "random_choice() of threat intelligence list names"
    
    - name: "detail.severity"
      type: "Integer"
      required: true
      description: "Finding severity level (varies by finding type)"
      example_value: "5"
      template_source: "random_choice([2, 2, 5, 5, 5, 8, 8]) - varies by finding type"
      possible_values:
        - value: "2"
          description: "Low severity (1.0-3.9) - e.g., AnomalousBehavior.FailedLogin, Discovery findings"
        - value: "5"
          description: "Medium severity (4.0-6.9) - e.g., MaliciousIPCaller.FailedLogin, TorIPCaller.FailedLogin, Discovery findings"
        - value: "8"
          description: "High severity (7.0-8.9) - e.g., AnomalousBehavior.SuccessfulBruteForce, MaliciousIPCaller.SuccessfulLogin, TorIPCaller.SuccessfulLogin"
  
  resources:
    documentation:
      - title: "RDS Protection Finding Types"
        url: "https://docs.aws.amazon.com/guardduty/latest/ug/findings-rds-protection.html"
        type: "official"
      - title: "Remediating Potentially Compromised Database with Successful Login Events"
        url: "https://docs.aws.amazon.com/guardduty/latest/ug/compromised-db-successful.html"
        type: "official"
      - title: "Remediating Potentially Compromised Database with Failed Login Events"
        url: "https://docs.aws.amazon.com/guardduty/latest/ug/compromised-db-failed.html"
        type: "official"
      - title: "GuardDuty RDS Protection"
        url: "https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_rds.html"
        type: "official"
      - title: "RDS Login Activity-Based Anomalies"
        url: "https://docs.aws.amazon.com/guardduty/latest/ug/rds-anomalies.html"
        type: "official"
    tools:
      - name: "AWS GuardDuty Console"
        description: "Web interface for viewing and managing RDS Protection findings"
        url: "https://console.aws.amazon.com/guardduty/"
      - name: "Amazon RDS Console"
        description: "Manage RDS database instances and clusters"
        url: "https://console.aws.amazon.com/rds/"
      - name: "AWS Security Hub"
        description: "Centralized security findings including GuardDuty RDS findings"
        url: "https://aws.amazon.com/security-hub/"

