vendor: aws
product: guardduty
data_source: findings
description: AWS GuardDuty Lambda Protection finding types detecting threats against AWS Lambda functions through network activity monitoring, including command and control communications, cryptocurrency mining, trojan activity, malicious IP access, and Tor network usage
format: JSON
frequency: medium
is_generator: true
base_frequency: 20
time_patterns:
  - business_hours
  - night_hours
  - weekend
business_hours_multiplier: 2.0
night_hours_multiplier: 1.5
weekend_multiplier: 1.0

documentation:
  display:
    title: "GuardDuty Lambda Protection Finding Types"
    subtitle: "Threat detection for AWS Lambda functions"
    icon: "âš¡"
    color_scheme: "error"
    tags:
      - "lambda"
      - "serverless"
      - "function"
      - "network-activity"
      - "threat-detection"
  
  overview:
    summary: "Lambda Protection monitors network activity from AWS Lambda functions to detect malicious behavior including command and control communications, cryptocurrency mining, trojan activity, malicious IP access, and Tor network usage. Uses threat intelligence and network pattern analysis to identify suspicious Lambda function behavior."
    when_generated:
      - "Lambda function queries IP address associated with known command and control server"
      - "Lambda function queries IP address associated with cryptocurrency-related activity"
      - "Lambda function exhibits blackhole traffic pattern"
      - "Lambda function exhibits drop point trojan activity"
      - "Lambda function makes connections to known malicious IP address (custom threat list)"
      - "Lambda function makes connections to Tor Guard or Authority node"
      - "Lambda function acts as Tor relay"
    security_relevance: "High"
    compliance_frameworks:
      - "PCI-DSS 11.4"
      - "HIPAA 164.312(b)"
      - "SOC 2 CC7.2"
      - "ISO 27001 A.12.4.1"
      - "NIST CSF PR.DS-5, DE.AE-3"
      - "CIS AWS Foundations 4.1-4.16"
    frequency_notes: "Lambda Protection findings frequency depends on Lambda function network activity and threat landscape. Production environments typically see 5-30 findings per day. C&C and cryptocurrency findings are high-severity but lower frequency (2-15 per day). Trojan activity findings are medium-severity (5-20 per day). Malicious IP and Tor findings indicate active attacks (3-15 per day during attacks). All Lambda Protection findings have High default severity (8.0)."
  
  fields:
    - name: "detail.type"
      type: "String"
      required: true
      description: "Lambda Protection finding type indicating attack category and detection method"
      example_value: "Backdoor:Lambda/C&CActivity.B"
      template_source: "random_choice() of 7 Lambda Protection finding types"
      possible_values:
        - value: "Backdoor:Lambda/C&CActivity.B"
          description: "Lambda function querying IP associated with known C&C server (severity: High)"
        - value: "CryptoCurrency:Lambda/BitcoinTool.B"
          description: "Lambda function querying IP associated with cryptocurrency activity (severity: High)"
        - value: "Trojan:Lambda/BlackholeTraffic"
          description: "Lambda function blackhole traffic pattern detected (severity: High)"
        - value: "Trojan:Lambda/DropPoint"
          description: "Lambda function drop point trojan activity detected (severity: High)"
        - value: "UnauthorizedAccess:Lambda/MaliciousIPCaller.Custom"
          description: "Lambda function making connections to known malicious IP (custom threat list) (severity: High)"
        - value: "UnauthorizedAccess:Lambda/TorClient"
          description: "Lambda function making connections to Tor Guard or Authority node (severity: High)"
        - value: "UnauthorizedAccess:Lambda/TorRelay"
          description: "Lambda function acting as Tor relay (severity: High)"
    
    - name: "detail.resource.resourceType"
      type: "String"
      required: true
      description: "Type of resource (always Lambda for Lambda Protection findings)"
      example_value: "Lambda"
      template_source: "Fixed value: 'Lambda'"
      possible_values:
        - value: "Lambda"
          description: "AWS Lambda function"
    
    - name: "detail.resource.lambdaDetails"
      type: "Object"
      required: true
      description: "Details about the Lambda function where activity was detected"
      example_value: "{functionArn, functionName, description, runtime, handler, role, vpcConfig}"
      template_source: "Lambda function metadata from GuardDuty"
    
    - name: "detail.resource.lambdaDetails.functionArn"
      type: "String"
      required: true
      description: "Amazon Resource Name (ARN) of the Lambda function"
      example_value: "arn:aws:lambda:us-east-1:123456789012:function:api-handler"
      format: "AWS Lambda function ARN"
      template_source: "Lambda function ARN from GuardDuty"
    
    - name: "detail.resource.lambdaDetails.functionName"
      type: "String"
      required: true
      description: "Name of the Lambda function"
      example_value: "api-handler"
      format: "Lambda function name"
      template_source: "Lambda function name from GuardDuty"
    
    - name: "detail.resource.lambdaDetails.runtime"
      type: "String"
      required: true
      description: "Runtime environment for the Lambda function"
      example_value: "python3.11"
      format: "Lambda runtime identifier"
      template_source: "random_choice() of Lambda runtime environments"
      possible_values:
        - value: "python3.11"
          description: "Python 3.11"
        - value: "python3.12"
          description: "Python 3.12"
        - value: "nodejs20.x"
          description: "Node.js 20.x"
        - value: "nodejs18.x"
          description: "Node.js 18.x"
        - value: "java17"
          description: "Java 17"
        - value: "java21"
          description: "Java 21"
        - value: "go1.x"
          description: "Go 1.x"
        - value: "ruby3.2"
          description: "Ruby 3.2"
        - value: "dotnet8"
          description: ".NET 8"
    
    - name: "detail.resource.lambdaDetails.handler"
      type: "String"
      required: true
      description: "Lambda function handler (entry point)"
      example_value: "index.handler"
      format: "Handler identifier"
      template_source: "random_choice() of common Lambda handlers"
    
    - name: "detail.resource.lambdaDetails.role"
      type: "String"
      required: true
      description: "IAM role ARN used by the Lambda function"
      example_value: "arn:aws:iam::123456789012:role/lambda-execution-role"
      format: "IAM role ARN"
      template_source: "Lambda execution role ARN"
    
    - name: "detail.resource.lambdaDetails.vpcConfig"
      type: "Object"
      required: false
      description: "VPC configuration for Lambda function (if function is in VPC)"
      example_value: "{vpcId, subnetIds, securityGroupIds}"
      template_source: "VPC configuration from Lambda function metadata"
    
    - name: "detail.service.action.actionType"
      type: "String"
      required: true
      description: "Type of action that triggered the finding"
      example_value: "NETWORK_CONNECTION"
      template_source: "random_choice(['NETWORK_CONNECTION', 'DNS_REQUEST'])"
      possible_values:
        - value: "NETWORK_CONNECTION"
          description: "Network connection from Lambda function"
        - value: "DNS_REQUEST"
          description: "DNS query from Lambda function"
    
    - name: "detail.service.action.networkConnectionAction.connectionDirection"
      type: "String"
      required: true
      description: "Direction of network connection (usually OUTBOUND for Lambda)"
      example_value: "OUTBOUND"
      template_source: "random_choice(['OUTBOUND', 'INBOUND'])"
      possible_values:
        - value: "OUTBOUND"
          description: "Lambda function initiated connection to remote host"
        - value: "INBOUND"
          description: "Remote host initiated connection to Lambda function (rare)"
    
    - name: "detail.service.action.networkConnectionAction.remoteIpDetails.ipAddressV4"
      type: "String"
      required: true
      description: "Remote IP address that Lambda function connected to"
      example_value: "203.0.113.42"
      format: "IPv4 address"
      template_source: "random_public_ip()"
    
    - name: "detail.service.action.networkConnectionAction.remotePortDetails.port"
      type: "Integer"
      required: true
      description: "Remote port number that Lambda function connected to"
      example_value: "443"
      format: "Integer (1-65535)"
      template_source: "random_choice() of common service ports"
      possible_values:
        - value: "80"
          description: "HTTP"
        - value: "443"
          description: "HTTPS"
        - value: "8333"
          description: "Bitcoin P2P"
        - value: "8332"
          description: "Bitcoin RPC"
        - value: "4444"
          description: "Common backdoor port"
        - value: "8080"
          description: "HTTP alternate"
    
    - name: "detail.service.action.networkConnectionAction.protocol"
      type: "String"
      required: true
      description: "Network protocol used"
      example_value: "TCP"
      template_source: "random_choice(['TCP', 'UDP'])"
      possible_values:
        - value: "TCP"
          description: "Transmission Control Protocol"
        - value: "UDP"
          description: "User Datagram Protocol"
    
    - name: "detail.service.action.dnsRequestAction.domain"
      type: "String"
      required: false
      description: "Domain name queried by Lambda function (for DNS-based findings)"
      example_value: "guarddutyc2activityb.com"
      format: "Domain name"
      template_source: "random_choice() of test and malicious domains"
    
    - name: "detail.service.additionalInfo.threatListName"
      type: "String"
      required: false
      description: "Name of threat intelligence list that matched"
      example_value: "ProofPoint"
      format: "Threat list name"
      template_source: "random_choice() of threat intelligence list names"
      possible_values:
        - value: "ProofPoint"
          description: "ProofPoint threat intelligence feed"
        - value: "Custom Threat List"
          description: "Custom user-defined threat list (for MaliciousIPCaller.Custom)"
        - value: "AWS Threat Intelligence"
          description: "AWS managed threat intelligence"
        - value: "Tor Exit Nodes"
          description: "Tor exit node list"
        - value: "Amazon"
          description: "Amazon threat intelligence (includes Log4j-related threats)"
    
    - name: "detail.service.additionalInfo.threatName"
      type: "String"
      required: false
      description: "Name of the specific threat identified"
      example_value: "C&C Server"
      format: "Threat name"
      template_source: "random_choice() of threat names"
      possible_values:
        - value: "C&C Server"
          description: "Command and control server"
        - value: "Bitcoin Mining"
          description: "Cryptocurrency mining activity"
        - value: "Tor Network"
          description: "Tor network node"
        - value: "Log4j Related"
          description: "Log4j vulnerability exploitation"
        - value: "Malicious Domain"
          description: "Known malicious domain"
    
    - name: "detail.severity"
      type: "Integer"
      required: true
      description: "Finding severity level (all Lambda Protection findings have High default severity)"
      example_value: "8"
      template_source: "random_choice([8, 8, 8]) - default is High"
      possible_values:
        - value: "8"
          description: "High severity (7.0-8.9) - default for all Lambda Protection findings"
  
  resources:
    documentation:
      - title: "Lambda Protection Finding Types"
        url: "https://docs.aws.amazon.com/guardduty/latest/ug/lambda-protection-finding-types.html"
        type: "official"
      - title: "Remediating Potentially Compromised Lambda Function"
        url: "https://docs.aws.amazon.com/guardduty/latest/ug/compromised-lambda.html"
        type: "official"
      - title: "GuardDuty Lambda Protection"
        url: "https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_lambda.html"
        type: "official"
      - title: "Lambda Network Activity Monitoring"
        url: "https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_lambda-network.html"
        type: "official"
    tools:
      - name: "AWS GuardDuty Console"
        description: "Web interface for viewing and managing Lambda Protection findings"
        url: "https://console.aws.amazon.com/guardduty/"
      - name: "AWS Lambda Console"
        description: "Manage Lambda functions and view execution logs"
        url: "https://console.aws.amazon.com/lambda/"
      - name: "AWS Security Hub"
        description: "Centralized security findings including GuardDuty Lambda findings"
        url: "https://aws.amazon.com/security-hub/"

