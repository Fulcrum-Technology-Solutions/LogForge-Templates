vendor: apache
product: httpd
data_source: access
description: Apache HTTP Server Common Log Format (CLF) access logs recording basic HTTP request information including client IP, authenticated user, timestamp, request details, and response status
format: Plain Text
frequency: high
is_generator: true
base_frequency: 300
time_patterns:
  - business_hours
  - night_hours
  - weekend
business_hours_multiplier: 3.0
night_hours_multiplier: 0.4
weekend_multiplier: 0.5

documentation:
  display:
    title: "Apache Common Log Format"
    subtitle: "Standard HTTP access logs with basic request information"
    icon: "ðŸ“‹"
    color_scheme: "info"
    tags:
      - "access-log"
      - "http"
      - "web-server"
      - "common-format"
      - "clf"
      - "traffic"

  overview:
    summary: "Records all HTTP requests to the Apache web server in the standardized Common Log Format (CLF), including client IP, authenticated user (if any), timestamp, HTTP request method and URI, status code, and response size. This is the most widely-used and standardized Apache log format."
    when_generated:
      - "Every HTTP/HTTPS request received by the Apache web server"
      - "GET, POST, PUT, DELETE, HEAD, OPTIONS, and other HTTP methods"
      - "Both successful requests and errors (2xx, 3xx, 4xx, 5xx status codes)"
      - "Requests to static content, dynamic pages, and APIs"
      - "Legacy systems and simple web servers often use CLF instead of Combined format"
    security_relevance: "High"
    compliance_frameworks:
      - "PCI DSS (Requirement 10.2 - Audit logging)"
      - "HIPAA (Access logging requirements)"
      - "SOX (Access audit trails)"
      - "GDPR (Access logging for personal data)"
      - "ISO 27001 (A.12.4.1 - Event logging)"
      - "NIST SP 800-53 (AU-2, AU-3 - Audit events)"
    frequency_notes: "High-frequency events during business hours (900 events/hour or ~4 per second) with reduced activity during nights (120 events/hour) and weekends (150 events/hour). Common Log Format is typically used for simpler web servers, static content servers, or legacy applications."

  fields:
    - name: "client_ip"
      type: "String"
      required: true
      description: "IP address of the client making the request"
      example_value: "192.168.1.100"
      format: "IPv4 or IPv6"
      template_source: "random_private_ip()"
      
    - name: "ident"
      type: "String"
      required: true
      description: "RFC 1413 identity of the client (typically '-' as ident lookups are rarely used)"
      example_value: "-"
      format: "Identity string or '-'"
      template_source: "random_choice(['-', registry.get_random_user().username])"
      
    - name: "authenticated_user"
      type: "String"
      required: true
      description: "Username of authenticated user, or '-' if not authenticated via HTTP Basic Authentication"
      example_value: "jsmith"
      format: "Username or '-'"
      template_source: "random_choice(['-', registry.get_random_user().username])"
      
    - name: "timestamp"
      type: "DateTime"
      required: true
      description: "Date and time of the request in Apache's standard format"
      example_value: "20/Dec/2025:15:31:10 -0600"
      format: "DD/Mon/YYYY:HH:MM:SS Timezone"
      template_source: "now() | format_datetime('%d/%b/%Y:%H:%M:%S %z')"
      
    - name: "request_method"
      type: "String"
      required: true
      description: "HTTP request method"
      example_value: "GET"
      format: "HTTP method verb"
      template_source: "random_choice(['GET', 'POST', 'PUT', 'DELETE', 'HEAD', 'OPTIONS'])"
      possible_values:
        - value: "GET"
          description: "Retrieve resource"
        - value: "POST"
          description: "Submit data to server"
        - value: "PUT"
          description: "Update existing resource"
        - value: "DELETE"
          description: "Remove resource"
        - value: "HEAD"
          description: "Retrieve headers only"
        - value: "OPTIONS"
          description: "Check allowed methods"
          
    - name: "request_uri"
      type: "String"
      required: true
      description: "URI path and query string of the request"
      example_value: "/index.html"
      format: "URI path"
      template_source: "random_choice of common web paths"
      
    - name: "http_version"
      type: "String"
      required: true
      description: "HTTP protocol version used for the request"
      example_value: "HTTP/1.1"
      format: "HTTP/x.x"
      template_source: "random_choice(['1.1', '2.0'])"
      possible_values:
        - value: "HTTP/1.1"
          description: "HTTP version 1.1 (most common)"
        - value: "HTTP/2.0"
          description: "HTTP version 2.0"
          
    - name: "status_code"
      type: "Integer"
      required: true
      description: "HTTP response status code returned by the server"
      example_value: "200"
      format: "3-digit HTTP status code"
      template_source: "random_weighted selection favoring successful responses"
      possible_values:
        - value: "200"
          description: "OK - Successful request"
        - value: "201"
          description: "Created - Resource created successfully"
        - value: "204"
          description: "No Content - Successful with no response body"
        - value: "301"
          description: "Moved Permanently - Resource moved"
        - value: "302"
          description: "Found - Temporary redirect"
        - value: "304"
          description: "Not Modified - Cached resource still valid"
        - value: "400"
          description: "Bad Request - Invalid request syntax"
        - value: "401"
          description: "Unauthorized - Authentication required"
        - value: "403"
          description: "Forbidden - Access denied"
        - value: "404"
          description: "Not Found - Resource not found"
        - value: "500"
          description: "Internal Server Error - Server error"
        - value: "502"
          description: "Bad Gateway - Upstream server error"
        - value: "503"
          description: "Service Unavailable - Server temporarily unavailable"
          
    - name: "response_size"
      type: "Integer"
      required: true
      description: "Size of response in bytes, not including HTTP headers (0 or '-' if no content sent)"
      example_value: "2326"
      format: "Bytes"
      template_source: "random_int(0, 500000)"

  resources:
    documentation:
      - title: "Apache HTTP Server Documentation - Log Files"
        url: "https://httpd.apache.org/docs/current/logs.html"
        type: "official"
      - title: "Apache Module mod_log_config"
        url: "https://httpd.apache.org/docs/current/mod/mod_log_config.html"
        type: "official"
      - title: "Common Log Format Specification"
        url: "https://httpd.apache.org/docs/current/logs.html#common"
        type: "official"
      - title: "W3C Common Logfile Format"
        url: "https://www.w3.org/Daemon/User/Config/Logging.html#common-logfile-format"
        type: "reference"
      - title: "HTTP Status Codes Reference"
        url: "https://developer.mozilla.org/en-US/docs/Web/HTTP/Status"
        type: "reference"
    tools:
      - name: "GoAccess"
        description: "Real-time web log analyzer and interactive viewer for Apache logs"
        url: "https://goaccess.io/"
      - name: "AWStats"
        description: "Advanced web statistics analyzer for Apache access logs"
        url: "https://awstats.sourceforge.io/"
      - name: "Webalizer"
        description: "Fast web server log file analysis program"
        url: "http://www.webalizer.org/"
      - name: "Analog"
        description: "Fast log file analyzer with extensive reporting options"
        url: "https://www.analog.cx/"