vendor: varonis
product: datadvantage
data_source: alerts
description: Records permission and access control changes detected by Varonis DatAdvantage, including excessive permission grants, global access modifications, and sensitive folder permission changes.
format: CEF
frequency: low
is_generator: true
base_frequency: 10
time_patterns:
  - business_hours
  - night_hours
  - weekend
business_hours_multiplier: 4.0
night_hours_multiplier: 0.2
weekend_multiplier: 0.1

documentation:
  display:
    title: "Permission Change Alert"
    subtitle: "Access control and permission modification monitoring"
    icon: "üîê"
    color_scheme: "warning"
    tags:
      - "permissions"
      - "access-control"
      - "privilege-escalation"
      - "data-security"

  overview:
    summary: "Alert generated when Varonis DatAdvantage detects changes to file system permissions, including excessive permission grants, global access modifications, or changes to sensitive data access controls."
    when_generated:
      - "User grants excessive permissions to files or folders"
      - "Global access permissions are granted to sensitive data"
      - "Permissions are modified on executive or confidential folders"
      - "User receives elevated access rights"
      - "Multiple permission changes occur in short timeframe"
      - "Permissions are removed or revoked unexpectedly"
    security_relevance: "High"
    compliance_frameworks:
      - "GDPR - Access Control Requirements"
      - "HIPAA - Technical Safeguards"
      - "SOX - Access Control Audit Trail"
      - "PCI DSS - Requirement 7 (Restrict Access)"
      - "NIST 800-53 - AC-3, AC-6"
      - "ISO 27001 - A.9.2 (User Access Management)"
    frequency_notes: "Low-medium frequency (5-15 alerts per day in typical deployments). Higher during business hours (4x multiplier) when administrative changes are more common. Rare during nights (0.2x) and weekends (0.1x) unless scheduled maintenance."

  fields:
    - name: "CEF Version"
      type: "Integer"
      required: true
      description: "CEF format version (always 0)"
      example_value: "0"
      template_source: "Static value"

    - name: "Device Vendor"
      type: "String"
      required: true
      description: "Vendor name (Varonis)"
      example_value: "Varonis"
      template_source: "Static value"

    - name: "Device Product"
      type: "String"
      required: true
      description: "Product name (DatAdvantage)"
      example_value: "DatAdvantage"
      template_source: "Static value"

    - name: "Device Version"
      type: "String"
      required: true
      description: "DatAdvantage version"
      example_value: "9.5"
      template_source: "random_choice(['8.0', '8.5', '9.0', '9.5'])"

    - name: "Signature ID"
      type: "Integer"
      required: true
      description: "Event operation code for permission changes (2000-2999 range)"
      example_value: "2543"
      template_source: "random_int(2000, 2999)"

    - name: "Name"
      type: "String"
      required: true
      description: "Event type/alert name"
      example_value: "Permission Change"
      template_source: "random_weighted event types"
      possible_values:
        - value: "Permission Change"
          description: "Standard permission modification"
        - value: "Excessive Permission Grant"
          description: "User granted more permissions than necessary"
        - value: "Global Access Granted"
          description: "Everyone group given access to sensitive data"
        - value: "Sensitive Folder Permission Change"
          description: "Permissions changed on classified data"
        - value: "Executive Data Permission Modified"
          description: "Access controls changed on executive folders"

    - name: "Severity"
      type: "String"
      required: true
      description: "Alert severity level (3=Medium, 5=High, 7=Very High)"
      example_value: "5"
      template_source: "random_weighted(['3', '5', '7'], [40, 50, 10])"

    - name: "cs6 (Changed Permissions)"
      type: "String"
      required: true
      description: "Description of permission changes"
      example_value: "Modified: Read to Full Control"
      template_source: "random_choice change types"
      possible_values:
        - value: "Added: [permission]"
          description: "New permission granted"
        - value: "Modified: [old] to [new]"
          description: "Existing permission changed"
        - value: "Removed: [permission]"
          description: "Permission revoked"

    - name: "oldFilePermission"
      type: "String"
      required: true
      description: "Previous permission level"
      example_value: "Read & Execute"
      template_source: "random_choice(['None', 'Read', 'Read & Execute'])"
      possible_values:
        - value: "None"
          description: "No previous access"
        - value: "Read"
          description: "Read-only access"
        - value: "Read & Execute"
          description: "Read and execute permissions"

    - name: "filePermission"
      type: "String"
      required: true
      description: "New permission level after change"
      example_value: "Full Control"
      template_source: "random_choice(['Modify', 'Full Control', 'Write'])"
      possible_values:
        - value: "Write"
          description: "Write access granted"
        - value: "Modify"
          description: "Modify permissions granted"
        - value: "Full Control"
          description: "Complete access granted"

    - name: "dpriv (Destination Privilege/Trustee)"
      type: "String"
      required: true
      description: "Username of the trustee receiving the permission change"
      example_value: "jsmith"
      template_source: "registry.get_random_user().username"

    - name: "rt (Receipt Time)"
      type: "DateTime"
      required: true
      description: "Alert generation timestamp"
      example_value: "Dec 05 2023 10:30:15 GMT"
      format: "MMM DD YYYY HH:MM:SS GMT"
      template_source: "now() | format_datetime"

    - name: "cat (Category)"
      type: "String"
      required: true
      description: "Event category (always 'Alert')"
      example_value: "Alert"
      template_source: "Static value"

    - name: "cs2 (Rule Name)"
      type: "String"
      required: true
      description: "Name of the detection rule that triggered the alert"
      example_value: "Excessive Permission Grants Alert"
      template_source: "random_choice(rule_names)"

    - name: "cn1 (Rule ID)"
      type: "Integer"
      required: true
      description: "Unique identifier for the detection rule"
      example_value: "3456"
      template_source: "random_int(1000, 9999)"

    - name: "end (Event Time)"
      type: "DateTime"
      required: true
      description: "Timestamp of the permission change event"
      example_value: "Dec 05 2023 10:25:30 GMT"
      format: "MMM DD YYYY HH:MM:SS GMT"
      template_source: "subtract_seconds(alert_time, random_int(30, 1800))"

    - name: "duser (Destination User)"
      type: "String"
      required: true
      description: "Username of the user who made the permission change"
      example_value: "admin"
      template_source: "registry.get_random_user().username"

    - name: "dhost (Destination Host)"
      type: "String"
      required: true
      description: "Hostname of the file server where permission was changed"
      example_value: "FS01"
      template_source: "registry.get_random_device().hostname"

    - name: "filePath"
      type: "String"
      required: true
      description: "UNC path to the resource with permission change"
      example_value: "\\\\FileServer\\Finance\\Payroll"
      template_source: "random_choice(file_paths)"

    - name: "act (Action)"
      type: "String"
      required: true
      description: "Action type (same as event type)"
      example_value: "Permission Change"
      template_source: "Same as event type"

    - name: "dvchost (Device Hostname)"
      type: "String"
      required: true
      description: "Hostname of the administrator's device"
      example_value: "ADMIN-01"
      template_source: "registry.get_random_device().hostname"

    - name: "dvc (Device Address)"
      type: "String"
      required: true
      description: "IP address of the administrator's device"
      example_value: "10.50.20.145"
      format: "IPv4"
      template_source: "registry.get_random_device().ip_address"

    - name: "outcome"
      type: "String"
      required: true
      description: "Result of the permission change"
      example_value: "Success"
      template_source: "random_weighted(['Success', 'Alerted'], [85, 15])"

    - name: "msg (Message)"
      type: "String"
      required: true
      description: "Human-readable alert description"
      example_value: "User admin modified permissions on \\\\FileServer\\Finance\\Payroll for trustee jsmith"
      template_source: "Dynamic message construction"

    - name: "cs4 (Alert URL)"
      type: "String"
      required: true
      description: "Direct link to alert details in DatAdvantage console"
      example_value: "http://10.10.10.50/DatAdvantage/#/app/analytics/entity/Alert/123456"
      format: "URL"
      template_source: "Constructed URL with random alert ID"

    - name: "cnt (Count)"
      type: "Integer"
      required: true
      description: "Number of permission changes in this alert"
      example_value: "3"
      template_source: "random_int(1, 10)"

    - name: "start (First Event Time)"
      type: "DateTime"
      required: true
      description: "Timestamp of the first permission change in sequence"
      example_value: "Dec 05 2023 09:30:15 GMT"
      format: "MMM DD YYYY HH:MM:SS GMT"
      template_source: "subtract_seconds(event_time, random_int(60, 3600))"

    - name: "externalId (Alert ID)"
      type: "Integer"
      required: true
      description: "Unique alert identifier"
      example_value: "123456"
      template_source: "random_int(100000, 999999)"

  resources:
    documentation:
      - title: "Varonis DatAdvantage Documentation"
        url: "https://www.varonis.com/products/datadvantage"
        type: "official"
      - title: "CEF Format Specification"
        url: "https://www.microfocus.com/documentation/arcsight/arcsight-smartconnectors-8.3/cef-implementation-standard/"
        type: "reference"
      - title: "Windows File System Permissions"
        url: "https://docs.microsoft.com/en-us/windows/security/identity-protection/access-control/access-control"
        type: "reference"
    tools:
      - name: "Varonis DatAdvantage Console"
        description: "Web-based console for alert management and investigation"
        url: "https://www.varonis.com"