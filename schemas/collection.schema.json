{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$id": "https://logforge.dev/schemas/collection.schema.json",
    "title": "Template Collection Schema",
    "description": "Schema for collection.json files that index templates for a product",
    "type": "object",
    "required": ["name", "version", "templates"],
    "properties": {
      "name": {
        "type": "string",
        "description": "Collection name, typically in format '{vendor}-{product}'",
        "pattern": "^[a-z0-9]+(-[a-z0-9]+)*$",
        "minLength": 3,
        "maxLength": 100,
        "examples": ["paloalto-wildfire", "microsoft-windows", "cisco-asa"]
      },
      "version": {
        "type": "string",
        "description": "Semantic version of the collection (semver format)",
        "pattern": "^(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)(?:-((?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\\.(?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\\+([0-9a-zA-Z-]+(?:\\.[0-9a-zA-Z-]+)*))?$",
        "examples": ["1.0.0", "2.1.3", "1.0.0-beta.1"]
      },
      "description": {
        "type": "string",
        "description": "Brief description of the template collection",
        "minLength": 10,
        "maxLength": 500,
        "examples": ["LogForge templates for Palo Alto WildFire threat detection logs"]
      },
      "maintainers": {
        "type": "array",
        "description": "List of collection maintainers",
        "items": {
          "type": "object",
          "required": ["name", "email"],
          "properties": {
            "name": {
              "type": "string",
              "description": "Maintainer full name",
              "minLength": 1,
              "maxLength": 100,
              "examples": ["John Owen"]
            },
            "email": {
              "type": "string",
              "description": "Maintainer email address",
              "format": "email",
              "examples": ["jowen@ftsc.com"]
            },
            "github": {
              "type": "string",
              "description": "GitHub username",
              "pattern": "^[a-zA-Z0-9](?:[a-zA-Z0-9]|-(?=[a-zA-Z0-9])){0,38}$",
              "examples": ["jowen-ftsc"]
            }
          },
          "additionalProperties": false
        },
        "minItems": 1
      },
      "tags": {
        "type": "array",
        "description": "Searchable tags for categorizing the collection",
        "items": {
          "type": "string",
          "pattern": "^[a-z0-9]+(-[a-z0-9]+)*$",
          "minLength": 2,
          "maxLength": 30
        },
        "uniqueItems": true,
        "examples": [["wildfire", "threat", "malware", "security"]]
      },
      "templates": {
        "type": "array",
        "description": "List of template paths relative to product directory. Format: '{data_source}/{template_name}' (without .j2 extension)",
        "items": {
          "type": "string",
          "pattern": "^[a-z0-9_-]+/[a-z0-9_-]+$",
          "examples": ["threats/wildfire_threat_detected", "analysis/file_analysis_complete"]
        },
        "minItems": 1,
        "uniqueItems": true
      }
    },
    "additionalProperties": false
  }