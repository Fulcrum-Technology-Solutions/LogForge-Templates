{%- set timestamp = current_timestamp() -%}
{%- set flow_id = random_int(1000000000000000, 9999999999999999) -%}
{%- set src_device = registry.get_random_device() -%}
{%- set dest_device = registry.get_random_device() -%}
{%- set domain = registry.get_domain() -%}
{%- set http_status_codes = [200, 201, 301, 302, 400, 401, 403, 404, 500] -%}
{%- set http_methods = ["GET", "POST", "PUT", "DELETE", "HEAD"] -%}
{%- set http_method = http_methods | random -%}
{%- set http_status = http_status_codes | random -%}
{%- set content_length = random_int(100, 10000) -%}
{
  "timestamp":"{{ timestamp | format_timestamp('%Y-%m-%dT%H:%M:%S.%f+0000') }}",
  "flow_id":{{ flow_id }},
  "in_iface":"ens5",
  "event_type":"fileinfo",
  "src_ip":"{{ src_device.ip_address }}",
  "src_port":{{ random_port() }},
  "dest_ip":"{{ dest_device.ip_address }}",
  "dest_port":{{ random_port() }},
  "proto":"TCP",
  "pkt_src":"wire/pcap",
  "http":{
    "hostname":"{{ domain }}",
    "url":"/oauth/idp/.well-known/openid-configuration",
    "http_user_agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.113 Safari/537.36 Assetnote/1.0.0",
    "xff":"127.0.0.1",
    "http_content_type":"text/html",
    "http_method":"{{ http_method }}",
    "protocol":"HTTP/1.1",
    "status":{{ http_status }},
    "redirect":"https://{{ domain }}/oauth/idp/.well-known/openid-configuration",
    "length":{{ content_length }}
  },
  "app_proto":"http",
  "fileinfo":{
    "filename":"/oauth/idp/.well-known/openid-configuration",
    "gaps":false,
    "state":"CLOSED",
    "stored":false,
    "size":{{ content_length }},
    "tx_id":{{ random_int(1, 999) }}
  }
}